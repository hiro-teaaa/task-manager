## この課題について

この文書は、Ruby on Railsとその周辺技術の基礎を習得するためのカリキュラムです。

## ライセンス

このカリキュラムは[クリエイティブ・コモンズ 表示 - 非営利 - 継承 4.0 国際 ライセンス](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja)の下に提供されています。

[![クリエイティブ・コモンズ・ライセンス](https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja)  

## 概要

### システムの要件

本カリキュラムでは、課題としてタスク管理システムを開発していただきます。
タスク管理システムでは、以下のことを行いたいと考えています。

- 自分のタスクを簡単に登録したい
- タスクに終了期限を設定できるようにしたい
- タスクに優先順位をつけたい
- ステータス（未着手・着手・完了）を管理したい
- ステータスでタスクを絞り込みたい
- タスク名・タスクの説明文でタスクを検索したい
- タスクを一覧したい。一覧画面で（優先順位、終了期限などを元にして）ソートしたい
- タスクにラベルなどをつけて分類したい
- ユーザ登録し、自分が登録したタスクだけを見られるようにしたい
- メンテナンスを実施できるようにしたい

### サポートブラウザ

- サポートブラウザはmacOS/Chrome各最新版を想定しています

### アプリケーション（サーバ）の構成について

以下の言語・ミドルウェアを使って構築していただきたいです（いずれも最新の安定バージョン）

- Ruby
- Ruby on Rails
- MySQL

※ 性能要求・セキュリティ要求は特に定めませんが、一般的な品質で作ってください。あまりにサイトのレスポンスが悪い場合は改善をしていただきます。

## 本カリキュラムの最終目標

本カリキュラムの終了時点で、以下の項目を習得することを想定しています。

- Railsを利用した基本的なWebアプリケーションの実装ができるようになること
- Railsアプリケーションで一般的な環境を使ってアプリケーションを公開できること
- 公開されたRailsアプリケーションに対して、機能の追加やデータのメンテナンスができること
- GitHubでPRをしてマージする一連の流れを習得すること。また、それに必要なGitのコマンドを習得すること
  - 適切な粒度でコミットができること
  - 適切にPRの説明文が書けること
  - レビューに対する対応と修正が一通りできること
- 不明な点や既知のバグ、今後取り組みたい課題などをGitHub issuesに起票し、チームメンバーと適切に情報共有ができること

## 課題ステップ

本カリキュラムは、[コチラ](https://github.com/everyleaf/el-training)の万葉さんが公開してくれているトレーニングを改定したものです。こちらに沿って実践いただきます。

## ステップ0: 開発準備

- 課題で作成するコードを管理するpublic repositoryをGitHubに作成して下さい。

### ステップ1: 開発環境を構築しよう

#### Gitのインストール

- 手元にGitをインストールしましょう
  - macOSの場合は `brew` などでインストールしてください
    - macOSは初めからインストールされていますが、最新版をインストールすることをお薦めします
  - `gitconfig` でユーザ名、メールアドレスを登録しましょう

### ステップ2: リポジトリの初期設定をしよう

- ブランチを作成しましょう
  - mainブランチを元に `develop` ブランチを作成してください
    - `git checkout -b develop origin/main`
  - 作成したらpushしましょう

### ステップ3: Railsプロジェクトを作成しよう

- rails new コマンドでアプリケーションに最低限必要なディレクトリやファイルを作成しましょう
- rails new してできたプロジェクトのディレクトリ（アプリ名のディレクトリ）の直下に docs というディレクトリを作り、この文書ファイルをコミットしましょう
  - このアプリの仕様を管理下に置き、いつでも見られるようにするためです
- 作成したアプリをGitHub上に作成したリポジトリにpushしましょう
- バージョンを明示するため、利用するRubyのバージョンを Gemfile に記載しましょう（Railsは既にバージョンが記載されていることを確認しましょう）

### ステップ4: 作りたいアプリケーションのイメージを考える

- 設計を進める前に、どのようなアプリになるか完成イメージを考えてみましょう。ペーパープロトタイピングによる画面設計などがおすすめです
- システムの要件を読んで、必要なデータ構造を考えてみましょう
  - どのようなモデル（テーブル）が必要そうか
  - テーブル内にどのような情報が必要そうか
- データ構造を考えたら、それをモデル図に手書きで書いてみましょう
  - ER図にしてもらっても可
- **テーブル設計が完了したら Issue にまとめて提出し、課題提出者へレビューを受けて下さい**
- [参考](https://github.com/Fablic/training/pull/1071)


### ステップ5: データベースの接続設定（周辺設定）をしよう

- まずGitで新たにトピックブランチを切りましょう
  - 以降、トピックブランチ上で作業をしてコミットをしていきます
- Bundlerをインストールしましょう
- `Gemfile` で `mysql2` をインストールしましょう
- `database.yml` の設定をしましょう
- `rails db:create` コマンドでデータベースの作成をしましょう
- `rails db` コマンドでデータベースへの接続確認をしましょう

### ステップ6: タスクモデルを作成しましょう

タスクを管理するためのCRUDを作成します。
まずは名前と詳細だけが登録できるシンプルな構成で作りましょう。

- `rails generate` コマンドでタスクのCRUDに必要なモデルクラスを作成しましょう
- マイグレーションを作成し、これを用いてテーブルを作成しましょう
  - マイグレーションは1つ前の状態に戻せることを担保できていることが大切です！ `redo` を流して確認する癖をつけましょう
  - DBの制約についても忘れず設定するようにしましょう
- `rails c` コマンドでモデル経由でデータベースに接続できることを確認しましょう
  - この時に試しにActiveRecordでレコードを作成してみましょう

### ステップ7: バリデーションを設定してみよう

- モデルにバリデーションを設定しましょう
  - どのカラムにどのバリデーションを追加したらよいか考えてみましょう
  - 合わせてDBの制約も設定するマイグレーションを作成しましょう
  - マイグレーションファイルだけを作成するため、 `rails generate` コマンドで作成します

### ステップ8: タスクを登録・更新・削除できるようにしよう

- タスクの一覧画面、作成画面、詳細画面、編集画面を作成しましょう
  - `rails generate` コマンドでコントローラとビューを作成します
  - コントローラとビューに必要な実装を追加しましょう
  - 作成、更新、削除後はそれぞれflashメッセージを画面に表示させましょう
- `routes.rb` を編集して、 `http://localhost:3000/` でタスクの一覧画面が表示されるようにしましょう

### ステップ9: テストを書こう

- specを書くための準備をしましょう
  - `spec/spec_helper.rb` 、 `spec/rails_helper.rb` を用意しましょう
- model specをバリデーションに対して書いてみましょう
- 参考書籍：https://leanpub.com/everydayrailsrspec-jp

### ステップ10: タスク一覧を作成日時の順番で並び替えましょう ★ スキップ可能

- 現在IDの順で並んでいますが、これを作成日時の降順で並び替えてみましょう

### ステップ11: 終了期限を追加しよう ★ スキップ可能

- タスクに対して、終了期限を登録できるようにしてみましょう
- 一覧画面で、終了期限でソートできるようにしましょう
- specを拡充しましょう

### ステップ12: ステータスを追加して、検索できるようにしよう

- ステータス（未着手・着手中・完了）を追加してみましょう
  - 【オプション】初学者ではない場合はstateを管理するGemを導入しても構いません
- 一覧画面でタイトルとステータスで検索ができるようにしましょう
  - 【オプション】初学者ではない場合はransackなどの検索の実装を便利にするGemを導入しても構いません
- 絞り込んだ際、ログを見て発行されるSQLの変化を確認してみましょう
  - 以降のステップでも必要に応じて確認する癖をつけましょう
- 検索インデックスを貼りましょう
- 検索に対してmodel specを追加してみましょう

### ステップ13: ページネーションを追加しよう

- KaminariというGemを使って一覧画面にページネーションを追加してみましょう

### ステップ14: デザインを当てよう ★ スキップ可能

- Bootstrapを導入して、これまで作成したアプリにデザインを当てましょう
  - 【オプション要件】自分でCSSを書いてデザインする

### ステップ15: 複数人で利用できるようにしよう（ユーザの導入）

- ユーザモデルを作成してみましょう
- 最初のユーザをseedで作成してみましょう
- ユーザとタスクが紐づくようにしましょう
  - 関連に対してインデックスを貼りましょう
  - N+1問題を回避するための仕組みを取り入れましょう

### ステップ16: ログイン/ログアウト機能を実装しよう ★ スキップ可能

- 追加のGemを使わず、自分で実装してみましょう
  - DeviseなどのGemを使わないことで、HTTPのCookieやRailsにおけるSessionなどの仕組みについて理解を深めることが目的です
  - また、一般的な認証についての理解を深めることも目的にしています（パスワードの取り扱いについてなど）
- ログイン画面を実装しましょう
- ログインしていない場合は、タスク管理のページに遷移できないようにしましょう
- タスクを作成したときに、タスクをログイン中のユーザに紐付けるようにしましょう
- 自分が作成したタスクだけを表示するようにしましょう
- ログアウト機能を実装しましょう

## あとがき

お疲れさまでした。
あなたは教育カリキュラムを一通り完遂しました!!

このカリキュラムでは触れきれませんでしたが、今後は以下のトピックなどが必要になると思うので、学習を進めていくとよいと思います（案件を通じて学ぶことも多いと思います）。

- Webアプリケーションの基本的な理解を深める
  - HTTPとHTTPSに関する理解
- Railsのもう少し進んだ使い方を習得する
  - STI
  - ロギング
  - 明示的なトランザクション
  - 非同期処理
  - アセットパイプライン（どちらかというとリリース系のトピック）
- JavaScriptやCSSなどのフロントエンドに関するより高度な理解
- データベースに対する理解を深める
  - SQL
  - よりパフォーマンスを重視したクエリの構築
  - インデックスの理解をより深める
- サーバ環境に関するより多くの理解
  - Linux OS
  - Webサーバ（Nginx）の設定
  - アプリケーションサーバ（Unicorn）の設定
  - PostgreSQLに関する設定への理解
- リリースに関するツールの理解
  - Capistrano
  - Ansible